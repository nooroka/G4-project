SAMPLES = ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"]
rule all:
     input:
        "../mutdensgene_40_v3/final/mutdensgene_quadr40_2-from_all_loop7_control2_corrected_v3-3_minus.txt",
        "../mutdensgene_40_v3/final/mutdensgene_non_quadr40_2-from_all_loop7_control2_corrected_v3-3_minus.txt",
        expand( "../mutdensgene_40_v3/mutdensgene_quadr40_2_{number}_all_loop7_control2_corrected_v3-3_minus.txt", number = SAMPLES),
        expand("../mutdensgene_40_v3/mutdensgene_non_quadr40_2_{number}_all_loop7_control2_corrected_v3-3_minus.txt",number = SAMPLES),
        "../mutdensgene_40_v3/final/out_control2_corrected_40_quadr_minus.csv",
        "../mutdensgene_40_v3/final/out_control2_corrected_40_non-quadr_minus.csv"

                                                                                       

rule sortrunnew5:
    input:
       x1 = "/data/nooroka/grant/punkt3/stage2/gccoords/quadr2/{number}_40_control3_cleaned_minus.bed",
       x2 = "/mnt/work/nooroka/punkt2/COSMIC_102/chr{number}_coordinates_shifted_tab_hgvsg.bed"
    output:
       "../mutdensgene_40_v3/mutdensgene_quadr40_2_{number}_all_loop7_control2_corrected_v3-3_minus.txt",
    shell:
       "bash ../scripts/sortrunnew5-3.sh {input.x1} {input.x2}  {output}"
rule sortrunnew55:
    input:
       x1 = "../gccoords/def/gccoords_{number}_undefhg19_40_all_loop7_control2_cleaned_minus.bed",
       x2 = "/mnt/work/nooroka/punkt2/COSMIC_102/chr{number}_coordinates_shifted_tab_hgvsg.bed"
    output:
       "../mutdensgene_40_v3/mutdensgene_non_quadr40_2_{number}_all_loop7_control2_corrected_v3-3_minus.txt",      
    shell:
       "bash ../scripts/sortrunnew55-3.sh {input.x1} {input.x2}  {output}"
rule cat:
     input:
        x1 = expand("../mutdensgene_40_v3/mutdensgene_quadr40_2_{number}_all_loop7_control2_corrected_v3-3_minus.txt", number = SAMPLES),
        x2 = expand("../mutdensgene_40_v3/mutdensgene_non_quadr40_2_{number}_all_loop7_control2_corrected_v3-3_minus.txt",number = SAMPLES)
     output:
        y1 = "../mutdensgene_40_v3/final/mutdensgene_quadr40_2-from_all_loop7_control2_corrected_v3-3_minus.txt",
        y2 = "../mutdensgene_40_v3/final/mutdensgene_non_quadr40_2-from_all_loop7_control2_corrected_v3-3_minus.txt"
     shell:
        """
        cat {input.x1} > {output.y1}
        cat {input.x2} > {output.y2}
        """

rule density:
      input:
        x1 = "../mutdensgene_40_v3/final/mutdensgene_quadr40_2-from_all_loop7_control2_corrected_v3-3_minus.txt",
        x2 = "../mutdensgene_40_v3/final/mutdensgene_non_quadr40_2-from_all_loop7_control2_corrected_v3-3_minus.txt"
      output:
        y1 = "../mutdensgene_40_v3/final/out_control2_corrected_40_quadr_minus.csv",
        y2 = "../mutdensgene_40_v3/final/out_control2_corrected_40_non-quadr_minus.csv"
      shell:
      	"""
      	python ../scripts/density_per_ch.py {input.x1} {output.y1}
      	python ../scripts/density_per_ch.py {input.x2} {output.y2}
      	"""	
